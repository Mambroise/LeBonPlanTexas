<!-- # ---------------------------------------------------------------------------
#                    L e B o n P l a n T e x a s   ( 2 0 2 4 )
# ---------------------------------------------------------------------------
# File   : appmain/templates/lebonplantexas/register_form.html
# Author : Morice
# --------------------------------------------------------------------------- -->



<div class="form-container">
    <h2>Étape {{ step }}</h2>

    {% if step == 1 or step == 2 %}
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Suivant</button>
        </form>
    {% elif step == 3 %}
        <h3>Choisissez une ou plusieurs catégories :</h3>
        <form id="category-form" method="post">
            {% csrf_token %}
            <div id="category-container">
                {% for category in categories %}
                    <div class="category-card" data-category-id="{{ category.id }}">
                        {{ category.name }}
                    </div>
                {% endfor %}
            </div>
            <!-- Champ caché pour transmettre les IDs des catégories sélectionnées -->
            <input type="hidden" name="categories" id="selected-categories" value="">
            <button type="submit">Valider</button>
        </form>
    {% endif %}
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const categoryCards = document.querySelectorAll(".category-card");
        const selectedCategoriesInput = document.getElementById("selected-categories");
        let selectedCategories = [];

        categoryCards.forEach(card => {
            card.addEventListener("click", function () {
                const categoryId = this.getAttribute("data-category-id");
                
                // Ajouter ou supprimer la catégorie de la sélection
                if (selectedCategories.includes(categoryId)) {
                    selectedCategories = selectedCategories.filter(id => id !== categoryId);
                    this.classList.remove("selected");
                } else {
                    selectedCategories.push(categoryId);
                    this.classList.add("selected");
                }

                // Mettre à jour l'input caché
                selectedCategoriesInput.value = selectedCategories.join(",");
            });
        });
    });
</script>

<style>
    #category-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .category-card {
        border: 2px solid #ccc;
        border-radius: 10px;
        padding: 10px 20px;
        cursor: pointer;
        transition: background-color 0.3s, border-color 0.3s;
        text-align: center;
    }

    .category-card:hover {
        border-color: #007bff;
    }

    .category-card.selected {
        background-color: #007bff;
        color: white;
        border-color: #0056b3;
    }
</style>
